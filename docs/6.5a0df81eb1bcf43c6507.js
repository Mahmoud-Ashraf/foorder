(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{M9Lh:function(e,t,r){"use strict";r.r(t),r.d(t,"ClientModule",function(){return ue});var n=r("ofXK"),s=r("fXoL"),i=r("sIil"),c=r("XNiG");let o=(()=>{class e{constructor(){this.date=this.calcTime(2),this.disableResturantDetails=new c.a}calcDateDiff(e="0:0:0"){const t=this.calcDateDiffInMs(e);if(t>0){let e=Math.floor(t/36e5%24);e<10&&(e="0"+e);let r=Math.floor(t/6e4%60);r<10&&(r="0"+r);let n=Math.floor(t/1e3)%60;return n<10&&(n="0"+n),{secondsToDday:n,minutesToDday:r,hoursToDday:e}}return{secondsToDday:"00",minutesToDday:"00",hoursToDday:"00"}}calcDateDiffInMs(e="0:0:0"){const t=e.split(":").map(e=>Number(e));return new Date(this.date.getFullYear(),this.date.getMonth(),this.date.getDate(),t[0],t[1],t[2]).valueOf()-this.calcTime(2).getTime()}calcTime(e){const t=new Date,r=t.getTime()+6e4*t.getTimezoneOffset();return new Date(r+36e5*e)}getDisableResturantDetails(){return this.disableResturantDetails.asObservable()}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=s.Hb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var l=r("/kEZ"),a=r("IYfF"),u=r("HDdC"),d=r("D0XW"),b=r("Y7HM");function h(e){const{subscriber:t,counter:r,period:n}=e;t.next(r),this.schedule({subscriber:t,counter:r+1,period:n},n)}var g=r("lJxs");function m(e,t){if(1&e&&(s.Qb(0,"p",1),s.Qb(1,"span",2),s.wc(2),s.Pb(),s.Qb(3,"span",2),s.wc(4),s.Pb(),s.Qb(5,"span",2),s.wc(6),s.Pb(),s.Pb()),2&e){const e=t.ngIf;s.zb(2),s.xc(e.hoursToDday),s.zb(2),s.xc(e.minutesToDday),s.zb(2),s.xc(e.secondsToDday)}}let f=(()=>{class e{constructor(e){this.homeService=e,this.timeLeft$=function(e=0,t=d.a){return(!Object(b.a)(e)||e<0)&&(e=0),t&&"function"==typeof t.schedule||(t=d.a),new u.a(r=>(r.add(t.schedule(h,e,{subscriber:r,counter:0,period:e})),r))}(1e3).pipe(Object(g.a)(e=>this.homeService.calcDateDiff(this.endTime)))}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)(s.Lb(o))},e.\u0275cmp=s.Fb({type:e,selectors:[["app-count-down"]],inputs:{endTime:"endTime"},decls:2,vars:3,consts:[["class","text-center",4,"ngIf"],[1,"text-center"],[1,"poll-timer"]],template:function(e,t){1&e&&(s.uc(0,m,7,3,"p",0),s.dc(1,"async")),2&e&&s.ic("ngIf",s.ec(1,1,t.timeLeft$))},directives:[n.n],pipes:[n.b],styles:[""]}),e})();const p=function(e,t){return{"alert-danger":e,"alert-success":t}};function v(e,t){if(1&e&&(s.Qb(0,"div",8),s.Qb(1,"p",9),s.wc(2),s.Pb(),s.Pb()),2&e){const e=s.cc();s.ic("ngClass",s.mc(2,p,"ERROR"===e.pollMsgType,"SUCCESS"===e.pollMsgType)),s.zb(2),s.xc(e.pollMsg)}}function w(e,t){1&e&&(s.Qb(0,"p",10),s.wc(1,"Thanks for your vote, wait the result in"),s.Pb())}function P(e,t){1&e&&(s.Qb(0,"p",10),s.wc(1,"Vote for one of this restaurants in"),s.Pb())}const y=function(e){return{selected:e}};function O(e,t){if(1&e){const e=s.Rb();s.Qb(0,"li",11),s.ac("click",function(){s.qc(e);const r=t.$implicit;return s.cc().selectResturant(r)}),s.Qb(1,"span"),s.wc(2),s.Pb(),s.Qb(3,"span"),s.wc(4),s.Pb(),s.Pb()}if(2&e){const e=t.$implicit,r=s.cc();s.ic("ngClass",s.lc(3,y,(null==r.selectedResturant?null:r.selectedResturant._id)===(null==e?null:e._id)&&!(null!=r.currentUser&&r.currentUser.voted))),s.zb(2),s.xc(null==e?null:e.name),s.zb(2),s.xc(null==e?null:e.vote)}}let S=(()=>{class e{constructor(e,t){this.resturantsService=e,this.authService=t}ngOnInit(){this.getResturants(),this.getUser()}selectResturant(e){var t;(null===(t=this.currentUser)||void 0===t?void 0:t.voted)||(this.selectedResturant=e)}vote(){var e;this.selectedResturant&&this.currentUser&&!(null===(e=this.currentUser)||void 0===e?void 0:e.voted)&&(this.selectedResturant.vote+=1,this.selectedResturant.lastVotedAt=(new Date).getFullYear()+"-"+((new Date).getMonth()+1)+"-"+(new Date).getDate(),this.currentUser.voted=!0,this.currentUser.lastVoteDate=(new Date).getFullYear()+"-"+((new Date).getMonth()+1)+"-"+(new Date).getDate(),this.updateResturant(this.selectedResturant._id,this.selectedResturant),this.updateUser(this.currentUser._id,this.currentUser),this.selectedResturant=void 0)}getResturants(){this.resturantsSub=this.resturantsService.getResturants().subscribe(e=>{this.resturants=e.resturants,this.resetResturantsVote()})}resetResturantsVote(){this.resturants.some(e=>(new Date).getDate()===new Date(e.lastVotedAt).getDate())||(this.resetResturantsVoteSub=this.resturantsService.resetResturantsVote().subscribe(e=>{this.resturants.forEach(e=>{e.vote=0})}))}updateResturant(e,t){this.updateResturantSub=this.resturantsService.updateResturant(e,t).subscribe(e=>{this.setPollMsg("Your Vote Submitted Successfully","SUCCESS")},e=>{this.setPollMsg("Somthing Went Wrong With Your Vote","ERROR")})}updateUser(e,t){this.updateUserSub=this.authService.updateUser(e,t).subscribe(e=>{this.setPollMsg("Your Vote Submitted Successfully","SUCCESS")},e=>{this.setPollMsg("Somthing Went Wrong With Your Vote","ERROR")})}setPollMsg(e,t){this.pollMsg=e,this.pollMsgType=t,setTimeout(()=>{this.pollMsg="",this.pollMsgType=""},4e3)}getUser(){this.currentUser=this.authService.getLoggedUser(),this.checkUserVote(),this.getUserSub=this.authService.getAuthUserListner().subscribe(e=>{this.currentUser=e,this.checkUserVote()})}checkUserVote(){var e;this.currentUser&&(this.currentUser.voted=(null===(e=this.currentUser)||void 0===e?void 0:e.lastVoteDate)==(new Date).getFullYear()+"-"+((new Date).getMonth()+1)+"-"+(new Date).getDate())}ngOnDestroy(){var e,t,r,n,s;null===(e=this.getUserSub)||void 0===e||e.unsubscribe(),null===(t=this.updateUserSub)||void 0===t||t.unsubscribe(),null===(r=this.resturantsSub)||void 0===r||r.unsubscribe(),null===(n=this.updateResturantSub)||void 0===n||n.unsubscribe(),null===(s=this.resetResturantsVoteSub)||void 0===s||s.unsubscribe()}}return e.\u0275fac=function(t){return new(t||e)(s.Lb(l.a),s.Lb(a.a))},e.\u0275cmp=s.Fb({type:e,selectors:[["app-poll"]],inputs:{pollEndTime:"pollEndTime"},decls:10,vars:6,consts:[[1,"row","justify-content-center","poll"],[1,"col-12"],["class","alert",3,"ngClass",4,"ngIf"],["class","poll-vote",4,"ngIf"],[3,"endTime"],[1,"poll-list"],[3,"ngClass","click",4,"ngFor","ngForOf"],[1,"btn","btn-primary","w-100","poll-submit",3,"disabled","click"],[1,"alert",3,"ngClass"],[1,"m-0"],[1,"poll-vote"],[3,"ngClass","click"]],template:function(e,t){1&e&&(s.Qb(0,"div",0),s.Qb(1,"div",1),s.uc(2,v,3,5,"div",2),s.uc(3,w,2,0,"p",3),s.uc(4,P,2,0,"p",3),s.Mb(5,"app-count-down",4),s.Qb(6,"ul",5),s.uc(7,O,5,5,"li",6),s.Pb(),s.Qb(8,"button",7),s.ac("click",function(){return t.vote()}),s.wc(9,"Submit Vote"),s.Pb(),s.Pb(),s.Pb()),2&e&&(s.zb(2),s.ic("ngIf",t.pollMsg),s.zb(1),s.ic("ngIf",null==t.currentUser?null:t.currentUser.voted),s.zb(1),s.ic("ngIf",!(null!=t.currentUser&&t.currentUser.voted)),s.zb(1),s.ic("endTime",t.pollEndTime),s.zb(2),s.ic("ngForOf",t.resturants),s.zb(1),s.ic("disabled",!t.selectedResturant||(null==t.currentUser?null:t.currentUser.voted)))},directives:[n.n,f,n.m,n.l],styles:[".poll-list[_ngcontent-%COMP%]   li.selected[_ngcontent-%COMP%]{background-color:var(--main-secondary-500)}"]}),e})();var T=r("c5gl"),Q=r("tyNb");function I(e,t){1&e&&(s.Qb(0,"p",19),s.wc(1,"Al72 Naf3na w Atlob El Order !!"),s.Pb())}function D(e,t){1&e&&(s.Qb(0,"p",19),s.wc(1,"t3ala bokra b2a 3shan ttlob tany :)"),s.Pb())}function R(e,t){if(1&e){const e=s.Rb();s.Qb(0,"button",28),s.ac("click",function(){s.qc(e);const t=s.cc().$implicit;return s.cc().decreseOrderCount(t)}),s.wc(1,"-"),s.Pb()}}function U(e,t){if(1&e){const e=s.Rb();s.Qb(0,"i",29),s.ac("click",function(){s.qc(e);const t=s.cc().$implicit;return s.cc().increaseOrderCount(t)}),s.Pb()}}function C(e,t){if(1&e){const e=s.Rb();s.Qb(0,"i",30),s.ac("click",function(){s.qc(e);const t=s.cc().$implicit;return s.cc().decreseOrderCount(t)}),s.Pb()}}function M(e,t){if(1&e&&(s.Qb(0,"span",31),s.wc(1),s.Pb()),2&e){const e=s.cc().$implicit;s.zb(1),s.xc(null==e?null:e.count)}}function z(e,t){if(1&e){const e=s.Rb();s.Qb(0,"button",28),s.ac("click",function(){s.qc(e);const t=s.cc().$implicit;return s.cc().increaseOrderCount(t)}),s.wc(1,"+"),s.Pb()}}function x(e,t){if(1&e&&(s.Qb(0,"tr",20),s.Qb(1,"td",13),s.Qb(2,"span"),s.wc(3),s.Pb(),s.Mb(4,"br"),s.Qb(5,"span",21),s.wc(6),s.Pb(),s.Pb(),s.Qb(7,"td",22),s.wc(8),s.Qb(9,"span",23),s.wc(10,"EGP"),s.Pb(),s.Pb(),s.Qb(11,"td"),s.uc(12,R,2,0,"button",24),s.uc(13,U,1,0,"i",25),s.uc(14,C,1,0,"i",26),s.uc(15,M,2,1,"span",27),s.uc(16,z,2,0,"button",24),s.Pb(),s.Pb()),2&e){const e=t.$implicit;s.zb(3),s.xc(null==e?null:e.name),s.zb(3),s.xc(null==e?null:e.ingredients),s.zb(2),s.yc(" ",null==e?null:e.price," "),s.zb(4),s.ic("ngIf",(null==e?null:e.count)>1),s.zb(1),s.ic("ngIf",0==e.count),s.zb(1),s.ic("ngIf",1==e.count),s.zb(1),s.ic("ngIf",(null==e?null:e.count)>0),s.zb(1),s.ic("ngIf",(null==e?null:e.count)>0&&(null==e?null:e.count)<2)}}const E=function(e){return{"pointer-events":e}};let k=(()=>{class e{constructor(e,t,r,n,s){this.resturantsService=e,this.menuService=t,this.homeService=r,this.router=n,this.authService=s,this.order={userId:"",resturantId:"",items:[],totalOrderPrice:0}}ngOnInit(){this.getUser(),this.getTodayResturant(),this.homeService.getDisableResturantDetails().subscribe(e=>{this.disableTodayResturant=e})}getMenu(){var e;this.getMenuSub=this.menuService.getMenu(null===(e=this.todayResturant)||void 0===e?void 0:e._id).subscribe(e=>{e.menu.forEach(e=>{e.count=0});let t=localStorage.getItem("order");if(t){const r=JSON.parse(t);e.menu=e.menu.filter(e=>this.getIndex(r.items,e._id)<0),e.menu=[...r.items,...e.menu]}this.todayResturantMenu=e.menu,this.getTodayOrder()})}getIndex(e,t){return e.findIndex(e=>e._id===t)}getTodayResturant(){this.getTodayResturantSub=this.resturantsService.getTodayResturant().subscribe(e=>{this.todayResturant=e,this.getMenu()})}addOrderToCart(){this.getTodayOrder(),localStorage.setItem("order",JSON.stringify(this.order)),this.router.navigate(["home/cart"])}getTodayOrder(){this.order.items=this.todayResturantMenu.filter(e=>e.count>0)}resetTodayResturant(){this.homeService.disableResturantDetails.next(!0),localStorage.removeItem("order")}ngOnDestroy(){var e,t;null===(e=this.getMenuSub)||void 0===e||e.unsubscribe(),null===(t=this.getTodayResturantSub)||void 0===t||t.unsubscribe()}decreseOrderCount(e){e.count-=1,this.getTodayOrder()}increaseOrderCount(e){e.count+=1,this.getTodayOrder()}getUser(){this.currentUser=this.authService.getLoggedUser(),this.checkUserOrdered(),this.getUserSub=this.authService.getAuthUserListner().subscribe(e=>{this.currentUser=e,this.checkUserOrdered()})}checkUserOrdered(){var e;this.userOrdered=null===(e=this.currentUser)||void 0===e?void 0:e.orders.some(e=>new Date(e.createdOn).getDate()===(new Date).getDate())}}return e.\u0275fac=function(t){return new(t||e)(s.Lb(l.a),s.Lb(T.a),s.Lb(o),s.Lb(Q.d),s.Lb(a.a))},e.\u0275cmp=s.Fb({type:e,selectors:[["app-today-resturant-details"]],inputs:{orderEndTime:"orderEndTime"},decls:28,vars:10,consts:[[1,"poll"],[1,"today-resturant","row","justify-content-between"],[1,"col-auto","resturant-welcome"],[1,"col-auto","text-center","resturant-brand"],[1,"row","justify-content-end","mb-3"],[1,"col-sm-4"],["target","_blank",1,"btn","btn-info","w-100",3,"href"],[1,"fas","fa-external-link-alt"],["class","poll-vote text-capitalize",4,"ngIf"],[3,"endTime"],[3,"ngStyle"],[1,"menu-table"],[1,"menu-table-head"],[1,"text-start"],[2,"min-width","60px"],["class","menu-table-items",4,"ngFor","ngForOf"],[1,"row","justify-content-end"],[1,"col-md-4"],[1,"btn","btn-primary","w-100",3,"disabled","click"],[1,"poll-vote","text-capitalize"],[1,"menu-table-items"],[1,"text-muted","fs-6"],[1,"menu-table-items-price"],[1,"menu-table-items-price-unit"],["class","btn btn-info btn-sm",3,"click",4,"ngIf"],["class","fas text-main fa-shopping-cart",3,"click",4,"ngIf"],["class","fas text-main-danger fa-trash",3,"click",4,"ngIf"],["class","cart-count",4,"ngIf"],[1,"btn","btn-info","btn-sm",3,"click"],[1,"fas","text-main","fa-shopping-cart",3,"click"],[1,"fas","text-main-danger","fa-trash",3,"click"],[1,"cart-count"]],template:function(e,t){1&e&&(s.Qb(0,"div",0),s.Qb(1,"p",1),s.Qb(2,"span",2),s.wc(3,"Restaurant of the Day"),s.Pb(),s.Qb(4,"span",3),s.wc(5),s.Pb(),s.Pb(),s.Qb(6,"div",4),s.Qb(7,"div",5),s.Qb(8,"a",6),s.Mb(9,"i",7),s.wc(10," Go To El Menus"),s.Pb(),s.Pb(),s.Pb(),s.uc(11,I,2,0,"p",8),s.uc(12,D,2,0,"p",8),s.Mb(13,"app-count-down",9),s.Qb(14,"div",10),s.Qb(15,"table",11),s.Qb(16,"tr",12),s.Qb(17,"th",13),s.wc(18,"Product Name"),s.Pb(),s.Qb(19,"th",14),s.wc(20,"Price"),s.Pb(),s.Qb(21,"th"),s.wc(22,"Add To Cart"),s.Pb(),s.Pb(),s.uc(23,x,17,8,"tr",15),s.Pb(),s.Qb(24,"div",16),s.Qb(25,"div",17),s.Qb(26,"button",18),s.ac("click",function(){return t.addOrderToCart()}),s.wc(27,"Checkout"),s.Pb(),s.Pb(),s.Pb(),s.Pb(),s.Pb()),2&e&&(s.zb(5),s.xc(null==t.todayResturant?null:t.todayResturant.name),s.zb(3),s.ic("href",null==t.todayResturant?null:t.todayResturant.elmenusUrl,s.rc),s.zb(3),s.ic("ngIf",!t.userOrdered),s.zb(1),s.ic("ngIf",t.userOrdered),s.zb(1),s.ic("endTime",t.orderEndTime),s.zb(1),s.ic("ngStyle",s.lc(8,E,t.userOrdered?"none":"auto")),s.zb(9),s.ic("ngForOf",t.todayResturantMenu),s.zb(3),s.ic("disabled",t.order.items.length<=0||t.userOrdered))},directives:[n.n,f,n.o,n.m],styles:[".today-resturant[_ngcontent-%COMP%]{color:#435971;font-weight:700;display:flex;align-items:center}.today-resturant[_ngcontent-%COMP%]   .resturant-welcome[_ngcontent-%COMP%]{font-size:2.1rem;line-height:2.9rem}.today-resturant[_ngcontent-%COMP%]   .resturant-brand[_ngcontent-%COMP%]{font-size:3.428rem;line-height:4.46rem}"]}),e})();function L(e,t){if(1&e&&s.Mb(0,"app-poll",3),2&e){const e=s.cc();s.ic("pollEndTime",e.pollEndTime)}}function F(e,t){if(1&e&&s.Mb(0,"app-today-resturant-details",4),2&e){const e=s.cc();s.ic("orderEndTime",e.orderEndTime)}}let _=(()=>{class e{constructor(e,t){this.helperService=e,this.homeService=t,this.pollEndTime="00:00:00",this.orderEndTime="00:00:00",this.showPoll=!1,this.showOrder=!1}ngOnInit(){this.getConfig()}getConfig(){this.getConfigSub=this.helperService.getConfig().subscribe(e=>{this.pollEndTime=e.config[0].voteEndTime,this.orderEndTime=e.config[0].orderEndTime,this.showHideDependOnCountDown()})}showHideDependOnCountDown(){this.showPoll=this.homeService.calcDateDiffInMs(this.pollEndTime)>0,this.showOrder=this.homeService.calcDateDiffInMs(this.orderEndTime)>0,this.pollCountDownTimer=setTimeout(()=>{this.showPoll=!1},this.homeService.calcDateDiffInMs(this.pollEndTime)),this.orderCountDownTimer=setTimeout(()=>{this.showOrder=!1},this.homeService.calcDateDiffInMs(this.orderEndTime))}ngOnDestroy(){var e;this.pollCountDownTimer&&clearTimeout(this.pollCountDownTimer),this.orderCountDownTimer&&clearTimeout(this.orderCountDownTimer),null===(e=this.getConfigSub)||void 0===e||e.unsubscribe()}}return e.\u0275fac=function(t){return new(t||e)(s.Lb(i.a),s.Lb(o))},e.\u0275cmp=s.Fb({type:e,selectors:[["app-home"]],decls:3,vars:2,consts:[[1,"home"],[3,"pollEndTime",4,"ngIf"],[3,"orderEndTime",4,"ngIf"],[3,"pollEndTime"],[3,"orderEndTime"]],template:function(e,t){1&e&&(s.Qb(0,"div",0),s.uc(1,L,1,1,"app-poll",1),s.uc(2,F,1,1,"app-today-resturant-details",2),s.Pb()),2&e&&(s.zb(1),s.ic("ngIf",t.showPoll),s.zb(1),s.ic("ngIf",t.showOrder&&!t.showPoll))},directives:[n.n,S,k],styles:[""]}),e})();var $=r("6iKd"),A=r("NuUg");const V=function(e,t){return{"alert-danger":e,"alert-success":t}};function N(e,t){if(1&e&&(s.Qb(0,"div",12),s.Qb(1,"p",13),s.wc(2),s.Pb(),s.Pb()),2&e){const e=s.cc();s.ic("ngClass",s.mc(2,V,"ERROR"===e.cartMsgType,"SUCCESS"===e.cartMsgType)),s.zb(2),s.xc(e.cartMsg)}}function j(e,t){if(1&e){const e=s.Rb();s.Qb(0,"button",18),s.ac("click",function(){s.qc(e);const t=s.cc().$implicit;return s.cc().decreseOrderCount(t)}),s.wc(1,"-"),s.Pb()}}function Y(e,t){if(1&e){const e=s.Rb();s.Qb(0,"i",19),s.ac("click",function(){s.qc(e);const t=s.cc().$implicit;return s.cc().increaseOrderCount(t)}),s.Pb()}}function q(e,t){if(1&e){const e=s.Rb();s.Qb(0,"i",20),s.ac("click",function(){s.qc(e);const t=s.cc().$implicit;return s.cc().decreseOrderCount(t)}),s.Pb()}}function J(e,t){if(1&e&&(s.Qb(0,"span",21),s.wc(1),s.Pb()),2&e){const e=s.cc().$implicit;s.zb(1),s.xc(null==e?null:e.count)}}function W(e,t){if(1&e){const e=s.Rb();s.Qb(0,"button",18),s.ac("click",function(){s.qc(e);const t=s.cc().$implicit;return s.cc().increaseOrderCount(t)}),s.wc(1,"+"),s.Pb()}}function G(e,t){if(1&e&&(s.Qb(0,"tr",5),s.Qb(1,"td",3),s.wc(2),s.Pb(),s.Qb(3,"td",7),s.wc(4),s.Qb(5,"span",8),s.wc(6,"EGP"),s.Pb(),s.Pb(),s.Qb(7,"td"),s.uc(8,j,2,0,"button",14),s.Qb(9,"a"),s.uc(10,Y,1,0,"i",15),s.Pb(),s.Qb(11,"a"),s.uc(12,q,1,0,"i",16),s.Pb(),s.uc(13,J,2,1,"span",17),s.uc(14,W,2,0,"button",14),s.Pb(),s.Qb(15,"td",7),s.wc(16),s.Qb(17,"span",8),s.wc(18,"EGP"),s.Pb(),s.Pb(),s.Pb()),2&e){const e=t.$implicit;s.zb(2),s.xc(null==e?null:e.name),s.zb(2),s.yc(" ",null==e?null:e.price," "),s.zb(4),s.ic("ngIf",(null==e?null:e.count)>1),s.zb(2),s.ic("ngIf",0==e.count),s.zb(2),s.ic("ngIf",1==e.count),s.zb(1),s.ic("ngIf",(null==e?null:e.count)>0),s.zb(1),s.ic("ngIf",(null==e?null:e.count)>0&&(null==e?null:e.count)<4),s.zb(2),s.yc(" ",e.price*e.count," ")}}let H=(()=>{class e{constructor(e,t,r,n){this.orderService=e,this.resturantsService=t,this.authService=r,this.homeService=n}ngOnInit(){this.getCurrentOrder()}getCurrentOrder(){let e=localStorage.getItem("order");e&&(this.order=JSON.parse(e),this.order.totalOrderPrice=this.getTotalOrderPrice(),this.order.grandTotal=this.getTotalOrderPrice())}increaseOrderCount(e){e.count+=1,this.editCartItems()}decreseOrderCount(e){e.count-=1,this.editCartItems()}editCartItems(){this.order.items=this.order.items.filter(e=>e.count>0),localStorage.setItem("order",JSON.stringify(this.order)),this.order.totalOrderPrice=this.getTotalOrderPrice(),this.order.grandTotal=this.getTotalOrderPrice()}submitOrder(){var e,t;this.order||(this.order={},this.order.items=[]);const r=null===(t=null===(e=this.order)||void 0===e?void 0:e.items)||void 0===t?void 0:t.map(e=>({item:{_id:e._id,name:e.name,price:e.price,resturantId:e.resturantId},count:e.count}));let n=Object.assign({},this.order);n.items=r,this.setUserAndResturantToOrder(n)}addOrder(e){this.addOrderSub=this.orderService.addOrder(e).subscribe(e=>{localStorage.removeItem("order"),this.order.items=[],this.homeService.disableResturantDetails.next(!0),this.setCartMsg(e.message,"SUCCESS")},e=>{this.setCartMsg(e.error.message,"ERROR")})}setCartMsg(e,t){this.cartMsg=e,this.cartMsgType=t,setTimeout(()=>{this.cartMsg="",this.cartMsgType=""},4e3)}setUserAndResturantToOrder(e){this.getTodayResturantSub=this.resturantsService.getTodayResturant().subscribe(t=>{e.resturantId=t._id,e.userId=this.authService.getLoggedUser()._id,this.addOrder(e)})}getTotalOrderPrice(){var e,t;return(null===(t=null===(e=this.order)||void 0===e?void 0:e.items)||void 0===t?void 0:t.length)>0?this.order.items.reduce((e,t)=>e+t.price*t.count,0):0}ngOnDestroy(){var e,t;null===(e=this.addOrderSub)||void 0===e||e.unsubscribe(),null===(t=this.getTodayResturantSub)||void 0===t||t.unsubscribe()}}return e.\u0275fac=function(t){return new(t||e)(s.Lb(A.a),s.Lb(l.a),s.Lb(a.a),s.Lb(o))},e.\u0275cmp=s.Fb({type:e,selectors:[["app-cart"]],decls:23,vars:4,consts:[["class","alert",3,"ngClass",4,"ngIf"],[1,"menu-table"],[1,"menu-table-head"],[1,"text-start"],["class","menu-table-items",4,"ngFor","ngForOf"],[1,"menu-table-items"],["colspan","3"],[1,"menu-table-items-price"],[1,"menu-table-items-price-unit"],[1,"row","justify-content-end"],[1,"col-md-4"],[1,"btn","btn-primary","w-100",3,"disabled","click"],[1,"alert",3,"ngClass"],[1,"m-0"],["class","btn btn-info btn-sm",3,"click",4,"ngIf"],["class","fas text-primary fa-shopping-cart",3,"click",4,"ngIf"],["class","fas text-main-danger fa-trash",3,"click",4,"ngIf"],["class","cart-count",4,"ngIf"],[1,"btn","btn-info","btn-sm",3,"click"],[1,"fas","text-primary","fa-shopping-cart",3,"click"],[1,"fas","text-main-danger","fa-trash",3,"click"],[1,"cart-count"]],template:function(e,t){1&e&&(s.uc(0,N,3,5,"div",0),s.Qb(1,"table",1),s.Qb(2,"tr",2),s.Qb(3,"th",3),s.wc(4,"Product Name"),s.Pb(),s.Qb(5,"th"),s.wc(6,"Price"),s.Pb(),s.Qb(7,"th"),s.wc(8,"Add To Cart"),s.Pb(),s.Qb(9,"th"),s.wc(10,"Total"),s.Pb(),s.Pb(),s.uc(11,G,19,8,"tr",4),s.Qb(12,"tr",5),s.Qb(13,"th",6),s.wc(14,"Total Price Without Taxes Or Delivery Fees"),s.Pb(),s.Qb(15,"td",7),s.wc(16),s.Qb(17,"span",8),s.wc(18,"EGP"),s.Pb(),s.Pb(),s.Pb(),s.Pb(),s.Qb(19,"div",9),s.Qb(20,"div",10),s.Qb(21,"button",11),s.ac("click",function(){return t.submitOrder()}),s.wc(22,"Confirm Order"),s.Pb(),s.Pb(),s.Pb()),2&e&&(s.ic("ngIf",t.cartMsg),s.zb(11),s.ic("ngForOf",null==t.order?null:t.order.items),s.zb(5),s.yc(" ",t.getTotalOrderPrice()," "),s.zb(5),s.ic("disabled",(null==t.order||null==t.order.items?null:t.order.items.length)<=0))},directives:[n.n,n.m,n.l],styles:[""]}),e})();var X=r("E9u9");function K(e,t){if(1&e&&(s.Qb(0,"p",17),s.wc(1),s.Pb()),2&e){const e=t.$implicit;s.zb(1),s.zc("",null==e?null:e.count,"\xd7 ",null==e||null==e.item?null:e.item.name,"")}}function Z(e,t){if(1&e){const e=s.Rb();s.Qb(0,"button",18),s.ac("click",function(){s.qc(e);const t=s.cc().$implicit;return s.cc(2).reorder(t)}),s.wc(1,"Reorder"),s.Pb()}}const B=function(e,t,r){return{"text-main":e,"text-success":t,"text-warning":r}};function ee(e,t){if(1&e&&(s.Qb(0,"div",6),s.Qb(1,"div",7),s.Qb(2,"div",8),s.Qb(3,"div"),s.Qb(4,"h5",9),s.wc(5),s.Pb(),s.Qb(6,"h6",10),s.wc(7),s.dc(8,"date"),s.Pb(),s.Pb(),s.Qb(9,"h6",11),s.wc(10),s.Pb(),s.Pb(),s.Qb(11,"div",12),s.uc(12,K,2,2,"p",13),s.Pb(),s.Qb(13,"div",14),s.Qb(14,"p",15),s.wc(15),s.Pb(),s.uc(16,Z,2,0,"button",16),s.Pb(),s.Pb(),s.Pb()),2&e){const e=t.$implicit,r=s.cc(2);s.zb(5),s.xc(null==e||null==e.resturantId?null:e.resturantId.name),s.zb(2),s.xc(s.fc(8,7,e.createdOn,"EEEE, d MMMM, y")),s.zb(2),s.ic("ngClass",s.nc(10,B,"DONE"===e.status,"ORDERED"===e.status,"PENDING"===e.status)),s.zb(1),s.xc(null==e?null:e.status),s.zb(2),s.ic("ngForOf",null==e?null:e.items),s.zb(3),s.yc("Total Order Price: ",null==e?null:e.grandTotal,""),s.zb(1),s.ic("ngIf",(null==e||null==e.resturantId?null:e.resturantId._id)===(null==r.todayResturant?null:r.todayResturant._id)&&r.checkForOrderingStart(r.pollEndTime)&&!r.userOrdered)}}function te(e,t){if(1&e&&(s.Qb(0,"div",4),s.uc(1,ee,17,14,"div",5),s.Pb()),2&e){const e=s.cc();s.zb(1),s.ic("ngForOf",e.orders.reverse())}}function re(e,t){1&e&&s.Mb(0,"app-no-data-found",19),2&e&&s.ic("msg","Sorry, No Orders Yet")}let ne=(()=>{class e{constructor(e,t,r,n,s,i){this.orderService=e,this.authService=t,this.resturantsService=r,this.router=n,this.homeService=s,this.helperService=i}ngOnInit(){this.loggedUser=this.authService.getLoggedUser(),this.userListnerSub=this.authService.getAuthUserListner().subscribe(e=>{this.loggedUser=e}),this.getuserOrders(),this.getTodayResturantId(),this.getConfig()}getuserOrders(){const e=localStorage.getItem("loggedUserId");e&&(this.getuserOrdersSub=this.orderService.getOrdersPerUser(e).subscribe(e=>{this.orders=e,this.checkUserOrdered(),console.log(this.orders)}))}getTodayResturantId(){this.getTodayResturantSub=this.resturantsService.getTodayResturant().subscribe(e=>{this.todayResturant=e})}ngOnDestroy(){var e,t,r,n;null===(e=this.userListnerSub)||void 0===e||e.unsubscribe(),null===(t=this.getuserOrdersSub)||void 0===t||t.unsubscribe(),null===(r=this.getTodayResturantSub)||void 0===r||r.unsubscribe(),null===(n=this.getConfigSub)||void 0===n||n.unsubscribe()}reorder(e){var t,r,n;if(this.checkForOrderingStart(this.pollEndTime)&&!this.userOrdered&&(null===(t=null==e?void 0:e.resturantId)||void 0===t?void 0:t._id)===(null===(r=this.todayResturant)||void 0===r?void 0:r._id)){delete e._id,delete e.deliveryFees,delete e.taxFees,delete e.discount,delete e.grandTotal,delete e.status,delete e.createdOn,e.userId="",e.resturantId="",e.totalOrderPrice=0;const t=null===(n=null==e?void 0:e.items)||void 0===n?void 0:n.map(e=>({_id:e.item._id,name:e.item.name,price:e.item.price,resturantId:e.item.resturantId,ingredients:e.item.ingredients,count:e.count}));e.items=t,localStorage.setItem("order",JSON.stringify(e)),this.router.navigate(["/home/cart"])}}checkForOrderingStart(e){return this.homeService.calcDateDiffInMs(e)<0}getConfig(){this.getConfigSub=this.helperService.getConfig().subscribe(e=>{this.pollEndTime=e.config[0].voteEndTime})}checkUserOrdered(){this.userOrdered=this.orders.some(e=>new Date(e.createdOn).getDate()===(new Date).getDate()),console.log(this.userOrdered)}}return e.\u0275fac=function(t){return new(t||e)(s.Lb(A.a),s.Lb(a.a),s.Lb(l.a),s.Lb(Q.d),s.Lb(o),s.Lb(i.a))},e.\u0275cmp=s.Fb({type:e,selectors:[["app-profile"]],decls:7,vars:3,consts:[[1,"row"],[1,"col-12"],["class","row g-3",4,"ngIf","ngIfElse"],["noOrdersFound",""],[1,"row","g-3"],["class","col-sm-6 col-md-4",4,"ngFor","ngForOf"],[1,"col-sm-6","col-md-4"],[1,"card","h-100"],[1,"card-header","d-flex","justify-content-between","align-items-center"],[1,"card-title"],[1,"card-subtitle","text-muted"],[3,"ngClass"],[1,"card-body"],["class","card-text",4,"ngFor","ngForOf"],[1,"card-footer"],[1,"badge","border","border-primary","m-0","d-block","fs-6","fw-normal","py-2","text-primary"],["class","btn btn-primary w-100 mt-2",3,"click",4,"ngIf"],[1,"card-text"],[1,"btn","btn-primary","w-100","mt-2",3,"click"],[3,"msg"]],template:function(e,t){if(1&e&&(s.Qb(0,"div",0),s.Qb(1,"div",1),s.Qb(2,"h2"),s.wc(3),s.Pb(),s.Pb(),s.Pb(),s.uc(4,te,2,1,"div",2),s.uc(5,re,1,1,"ng-template",null,3,s.vc)),2&e){const e=s.pc(6);s.zb(3),s.yc("Welcome, ",null==t.loggedUser?null:t.loggedUser.name,""),s.zb(1),s.ic("ngIf",(null==t.orders?null:t.orders.length)>0)("ngIfElse",e)}},directives:[n.n,n.m,n.l,X.a],pipes:[n.e],styles:[""]}),e})();const se=function(e,t){return{"text-danger":e,"text-success":t}};let ie=(()=>{class e{constructor(e){this.authService=e}ngOnInit(){this.loggedUser=this.authService.getLoggedUser(),this.userListnerSub=this.authService.getAuthUserListner().subscribe(e=>{this.loggedUser=e})}ngOnDestroy(){var e;null===(e=this.userListnerSub)||void 0===e||e.unsubscribe()}}return e.\u0275fac=function(t){return new(t||e)(s.Lb(a.a))},e.\u0275cmp=s.Fb({type:e,selectors:[["app-wallet"]],decls:15,vars:9,consts:[[1,"row","justify-content-center"],[1,"col-sm-8","col-md-6"],[1,"card","h-100"],[1,"card-header"],[1,"card-title"],[1,"card-body"],[1,"card-text","text-center","fs-1"],[1,"card-footer","text-center"],[1,"mb-0","fs-5","text-capitalize",3,"ngClass"],[1,"mb-0","fs-5","text-capitalize","text-primary"]],template:function(e,t){1&e&&(s.Qb(0,"div",0),s.Qb(1,"div",1),s.Qb(2,"div",2),s.Qb(3,"div",3),s.Qb(4,"h5",4),s.wc(5),s.Pb(),s.Pb(),s.Qb(6,"div",5),s.Qb(7,"p",6),s.wc(8),s.dc(9,"number"),s.Pb(),s.Pb(),s.Qb(10,"div",7),s.Qb(11,"p",8),s.wc(12),s.Pb(),s.Qb(13,"p",9),s.wc(14,"3ayz tdf3? t3laaaaaaly :)"),s.Pb(),s.Pb(),s.Pb(),s.Pb(),s.Pb()),2&e&&(s.zb(5),s.yc("",null==t.loggedUser?null:t.loggedUser.name,"'s Wallet"),s.zb(3),s.xc(s.ec(9,4,null==t.loggedUser?null:t.loggedUser.wallet)),s.zb(3),s.ic("ngClass",s.mc(6,se,(null==t.loggedUser?null:t.loggedUser.wallet)<0,(null==t.loggedUser?null:t.loggedUser.wallet)>=0)),s.zb(1),s.xc((null==t.loggedUser?null:t.loggedUser.wallet)<0?"Adf3 elly 3leeeek el awel":"A7bk wenta btdf3 awel bawel"))},directives:[n.l],pipes:[n.f],styles:[""]}),e})();var ce=r("7/bn");const oe=[{path:"",component:(()=>{class e{constructor(){}ngOnInit(){}ngOnDestroy(){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=s.Fb({type:e,selectors:[["app-client"]],decls:5,vars:0,consts:[[1,"row"],[1,"col-md-3"],[1,"col-md-9","py-4"]],template:function(e,t){1&e&&(s.Qb(0,"div",0),s.Qb(1,"div",1),s.Mb(2,"app-aside"),s.Pb(),s.Qb(3,"div",2),s.Mb(4,"router-outlet"),s.Pb(),s.Pb())},directives:[ce.a,Q.h],styles:[""]}),e})(),children:[{path:"",component:_,canActivate:[$.a]},{path:"cart",component:H,canActivate:[$.a]},{path:"wallet",component:ie,canActivate:[$.a]},{path:"profile",component:ne,canActivate:[$.a]}]}];let le=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=s.Jb({type:e}),e.\u0275inj=s.Ib({imports:[[Q.g.forChild(oe)],Q.g]}),e})();var ae=r("PCNd");let ue=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=s.Jb({type:e}),e.\u0275inj=s.Ib({imports:[[n.c,le,ae.a]]}),e})()}}]);